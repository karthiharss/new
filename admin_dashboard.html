<?php
include "db.php";
include "auth_check.php";

$missing = mysqli_query($conn,"SELECT * FROM missing_pets ORDER BY created_at DESC ");
$found   = mysqli_query($conn,"SELECT * FROM found_pets ORDER BY created_at DESC");
?>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
    margin:0;
    font-family:Poppins, sans-serif;
    background:#f5f7fb;
}

/* ===== SIDEBAR ===== */
.sidebar{
    position:fixed;
    left:0; top:0;
    width:80px;
    height:100%;
    background:#ffffff;
    border-right:1px solid #eee;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding-top:20px;
    z-index:100;
}
.logo{
    font-size:22px;
    margin-bottom:30px;
}
.sidebar a{
    width:48px;
    height:48px;
    margin-bottom:18px;
    border-radius:14px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
    color:#777;
    text-decoration:none;
    transition:.2s;
}
.sidebar a.active,
.sidebar a:hover{
    background:#ff6f61;
    color:white;
}

/* ===== MAIN CONTENT ===== */
.main{
    margin-left:110px;
    padding:30px;
}
.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:25px;
}

/* ===== CARD GRID ===== */
.cards{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
    gap:22px;
}
.card{
    background:#fff;
    border-radius:20px;
    padding:18px;
    box-shadow:0 10px 30px rgba(0,0,0,.08);
    position:relative;
}
.status{
    position:absolute;
    top:15px;
    right:15px;
    background:#e8f7ee;
    color:#22a06b;
    font-size:12px;
    padding:4px 10px;
    border-radius:999px;
    font-weight:600;
}
.avatar{
    width:80px;
    height:80px;
    margin:auto;
    border-radius:50%;
    overflow:hidden;
    border:4px solid #f2f2f2;
}
.avatar img{
    width:100%;
    height:100%;
    object-fit:cover;
}
.card h4{
    text-align:center;
    margin:12px 0 4px;
}
.card small{
    display:block;
    text-align:center;
    color:#777;
}
.info{
    margin-top:12px;
    font-size:13px;
    color:#444;
}
.info div{
    margin-bottom:6px;
}
.footer{
    margin-top:12px;
    font-size:12px;
    color:#999;
    text-align:center;
}
.section-title{
    margin:30px 0 15px;
}
</style>
</head>

<body>

<!-- ===== SIDEBAR (INSIDE DASHBOARD) ===== -->
<div class="sidebar">
    <div class="logo">üêæ</div>
    <a href="admin_dashboard.php" class="active" title="Dashboard">üè†</a>
    <a href="admin_missing_pets.php" title="Missing Pets">üîç</a>
    <a href="admin_found_pets.php" title="Found Pets">üê∂</a>
    <a href="logout.php" title="Logout">üö™</a>
</div>

<!-- ===== MAIN ===== -->
<div class="main">

<div class="header">
    <h2>Admin Dashboard</h2>
</div>

<h3 class="section-title">Missing Pets</h3>
<div class="cards">
<?php while($m=mysqli_fetch_assoc($missing)){ ?>
<div class="card">
    <div class="status">Missing</div>

    <div class="avatar">
        <img src="<?= $m['pet_image'] ?: 'assets/no-pet.png' ?>">
    </div>

    <h4><?= htmlspecialchars($m['pet_name']) ?></h4>
    <small><?= htmlspecialchars($m['breed']) ?></small>

    <div class="info">
        <div>üìç <?= htmlspecialchars($m['address']) ?></div>
        <div>‚òé <?= htmlspecialchars($m['contact']) ?></div>
    </div>

    <div class="footer">
        <?= date("d M Y", strtotime($m['created_at'])) ?>
    </div>
</div>
<?php } ?>
</div>

<h3 class="section-title">Found Pets</h3>
<div class="cards">
<?php while($f=mysqli_fetch_assoc($found)){ ?>
<div class="card">
    <div class="status">Found</div>

    <div class="avatar">
        <img src="<?= $f['image'] ?: 'assets/no-pet.png' ?>">
    </div>

    <h4><?= htmlspecialchars($f['species']) ?></h4>
    <small><?= htmlspecialchars($f['breed']) ?></small>

    <div class="info">
        <div>üìç <?= htmlspecialchars($f['location_found']) ?></div>
        <div>‚òé <?= htmlspecialchars($f['contact']) ?></div>
    </div>

    <div class="footer">
        <?= date("d M Y", strtotime($f['created_at'])) ?>
    </div>
</div>
<?php } ?>
</div>

</div>
</body>
</html>
